#!/usr/bin/env bash

# exec nix-shell neuron "$@"

dir="$PWD"
args=()
while [ $# -gt 0 ]; do
	if [ "$1" = "-d" ] && [ -n "$2" ]; then
		dir="$2"
		shift 2
	else
		args=("${args[@]}" "$1")
		shift
	fi
done
dir="$(realpath "$dir")"

hash="$(md5sum <<<"$dir" | cut -c1-32)"
containername="neuron-$hash"

exec docker-worker-run "$containername" neuron -d /zettelkasten "${args[@]}"
